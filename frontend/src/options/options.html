<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitbucket PR Helper Options</title>
    <link rel="stylesheet" href="options.css">
</head>
<body>
    <h1>Extension Options</h1>
    <div id="options-content">
        <h2>Template Management</h2>

        <div id="template-list-container">
            <h3>Current Templates</h3>
            <ul id="template-list">
                <li>No templates loaded yet.</li>
            </ul>
        </div>

        <div id="template-form-container">
            <h3 id="template-form-heading">Add New Template</h3>
            
            <!-- Template Suggestions Section -->
            <div id="template-suggestions" style="background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                <h4 style="margin-top: 0; color: #495057;">üí° Template Variables & Examples</h4>
                
                <details style="margin-bottom: 15px;">
                    <summary style="cursor: pointer; font-weight: bold; color: #007bff;">üìù Currently Available Variables</summary>
                    <div style="margin-top: 10px; font-family: monospace; font-size: 12px;">
                        <div style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; padding: 10px; margin-bottom: 10px;">
                            <strong>‚úÖ Currently Supported:</strong><br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{DIFF_CONTENT}</code> - The complete git diff content<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{PULL_REQUEST_TITLE}</code> - Pull request title<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{PULL_REQUEST_BODY}</code> - PR description/body<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{AUTHOR}</code> - PR author name<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{BRANCH_NAME}</code> - Source branch name<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{REPO_NAME}</code> - Repository name<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{COMMIT_MESSAGES}</code> - Commit messages summary<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{DIFF_SUMMARY}</code> - Brief summary of changes<br>
                            <code style="background-color: #fff; padding: 2px 4px; border-radius: 3px;">{FILES_CHANGED}</code> - List of modified files
                        </div>
                        
                        <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 10px;">
                            <strong>üöß Template Usage Tips:</strong><br>
                            <small style="color: #856404;">
                                ‚Ä¢ Use single braces with uppercase names: <code>{PLACEHOLDER}</code><br>
                                ‚Ä¢ All placeholders are optional - use only what you need<br>
                                ‚Ä¢ {DIFF_CONTENT} is the most commonly used placeholder<br>
                                ‚Ä¢ Templates are processed by AI, so natural language instructions work well
                            </small>
                        </div>
                    </div>
                </details>
                
                <details style="margin-bottom: 15px;">
                    <summary style="cursor: pointer; font-weight: bold; color: #28a745;">üöÄ Feature Development Template</summary>
                    <textarea readonly style="width: 100%; height: 150px; margin-top: 10px; font-family: monospace; font-size: 12px; background-color: #f8f9fa; border: 1px solid #dee2e6;">## üéØ Overview
Based on the code changes in this PR, please provide a comprehensive description.

## üìù Changes Made
Please analyze the following diff and describe the key changes:

{DIFF_CONTENT}

## üìã PR Details
- **Title**: {PULL_REQUEST_TITLE}
- **Author**: {AUTHOR}
- **Branch**: {BRANCH_NAME}
- **Repository**: {REPO_NAME}
- **Files Modified**: {FILES_CHANGED}

## üß™ Testing
Please suggest appropriate testing strategies based on the code changes.

## üì¶ Deployment Notes
Please identify any deployment considerations from the changes.

## üîó Related
Please mention any related issues or dependencies if evident from the code.</textarea>
                </details>
                
                <details style="margin-bottom: 15px;">
                    <summary style="cursor: pointer; font-weight: bold; color: #dc3545;">üêõ Bug Fix Template</summary>
                    <textarea readonly style="width: 100%; height: 120px; margin-top: 10px; font-family: monospace; font-size: 12px; background-color: #f8f9fa; border: 1px solid #dee2e6;">## üêõ Bug Fix: {PULL_REQUEST_TITLE}
**Author:** {AUTHOR}
**Branch:** {BRANCH_NAME}
**Repository:** {REPO_NAME}

## üìù Issue Description
{PULL_REQUEST_BODY}

## üîç Root Cause & Solution
Based on the following diff, explain the root cause and solution:

{DIFF_CONTENT}

## üìã Files Changed
{FILES_CHANGED}

## ‚úÖ Verification
Please suggest how to verify this fix works correctly.</textarea>
                </details>
                
                <details>
                    <summary style="cursor: pointer; font-weight: bold; color: #6f42c1;">üîß Refactoring Template</summary>
                    <textarea readonly style="width: 100%; height: 100px; margin-top: 10px; font-family: monospace; font-size: 12px; background-color: #f8f9fa; border: 1px solid #dee2e6;">## ‚ôªÔ∏è Refactoring: {PULL_REQUEST_TITLE}
**Author:** {AUTHOR}
**Branch:** {BRANCH_NAME}
**Repository:** {REPO_NAME}

## üìù Motivation
{PULL_REQUEST_BODY}

## üîÑ Code Changes
{DIFF_CONTENT}

## üìã Summary of Changes
- **Files Modified**: {FILES_CHANGED}
- **Commit Messages**: {COMMIT_MESSAGES}

## üéØ Benefits
Please explain the benefits of these refactoring changes.</textarea>
                </details>
            </div>

            <input type="hidden" id="template-id" name="template-id">
            <div>
                <label for="template-name">Name:</label>
                <input type="text" id="template-name" name="template-name">
            </div>
            <div>
                <label for="template-content">Content:</label>
                <textarea id="template-content" name="template-content" rows="10" cols="50"></textarea>
            </div>
            <div>
                <button type="button" id="preview-template-button">Preview Template</button>
            </div>
            <div id="template-preview-area" style="white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; margin-top: 10px; min-height: 50px; background-color: #f9f9f9;">
                <p><em>Preview will appear here...</em></p>
            </div>
            <button id="save-template-button">Save New Template</button>
            <button type="button" id="clear-template-form-button">Clear Form / New</button>
        </div>

        <div id="template-import-export-container" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
        <h3>Manage All Settings</h3>
        <button type="button" id="export-templates-button">Export All Settings (JSON)</button>
        <button type="button" id="import-templates-button">Import All Settings (JSON)</button>
            <input type="file" id="import-file-input" accept=".json" style="display: none;">
        </div>

        <hr style="margin: 20px 0;">
        <h2>LLM Provider Configuration</h2>
        <div id="llm-config-container">
            <div>
                <label for="llm-provider-select">Select LLM Provider:</label>
                <select id="llm-provider-select" name="llm-provider-select">
                    <option value="">-- Loading Providers --</option>
                </select>
            </div>
            <div id="llm-provider-settings-container" style="margin-top: 15px; padding: 10px; border: 1px solid #eee;">
                <p><em>Select a provider to see its settings.</em></p>
            </div>
            <div id="llm-provider-helptext-container" style="margin-top: 10px; font-style: italic; color: #555;">
            </div>
             <button type="button" id="save-llm-config-button" style="margin-top:15px;">Save LLM Configuration</button>
        </div>

        <div id="storage-management-container" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
            <h3>Storage Management</h3>
            <div id="storage-info-display">
                <div class="storage-usage-section">
                    <h4>Storage Usage</h4>
                    <div class="storage-usage-bar-container">
                        <div id="storage-usage-bar" class="storage-usage-bar">
                            <div id="storage-usage-fill" class="storage-usage-fill"></div>
                        </div>
                        <div id="storage-usage-text">Loading...</div>
                    </div>
                    <div id="storage-breakdown" class="storage-breakdown">
                        <!-- Breakdown will be populated by JavaScript -->
                    </div>
                </div>
                <div class="storage-actions-section">
                    <h4>Storage Actions</h4>
                    <button type="button" id="refresh-storage-info-button">Refresh Usage Info</button>
                    <button type="button" id="cleanup-storage-button">Clean Up Storage</button>
                </div>
                <div class="storage-settings-section">
                    <h4>Cleanup Settings</h4>
                    <div class="cleanup-setting">
                        <label for="auto-cleanup-enabled">
                            <input type="checkbox" id="auto-cleanup-enabled"> Enable automatic cleanup
                        </label>
                    </div>
                    <div class="cleanup-setting">
                        <label for="max-templates">Maximum templates to keep:</label>
                        <input type="number" id="max-templates" min="5" max="100" value="20">
                    </div>
                    <div class="cleanup-setting">
                        <label for="cleanup-strategy">Cleanup strategy:</label>
                        <select id="cleanup-strategy">
                            <option value="oldest">Remove oldest templates first</option>
                            <option value="largest">Remove largest templates first</option>
                            <option value="leastUsed">Remove least used templates first</option>
                        </select>
                    </div>
                    <div class="cleanup-setting">
                        <label for="warning-threshold">Warning threshold (%):</label>
                        <input type="number" id="warning-threshold" min="50" max="95" value="80">
                    </div>
                    <button type="button" id="save-cleanup-settings-button">Save Cleanup Settings</button>
                </div>
            </div>
        </div>

    </div>
    <script src="options.js"></script>
</body>
</html>
